# Инструкции по настройке Email для регистрации

## Проблема
При нажатии "Зарегистрироваться" происходит бесконечная загрузка, и письмо не отправляется на почту.

## Решение

### Вариант 1: Использование Gmail (Рекомендуется)

1. **Создайте Gmail аккаунт** (если у вас его нет)

2. **Включите двухфакторную аутентификацию** в настройках Google аккаунта

3. **Создайте пароль приложения**:
   - Перейдите в настройки Google аккаунта
   - Безопасность → Пароли приложений
   - Создайте новый пароль для приложения
   - Скопируйте сгенерированный пароль

4. **Обновите конфигурацию** в файле `lib/config/email_config.dart`:
   ```dart
   static const String senderEmail = 'ваш-email@gmail.com';
   static const String senderPassword = 'ваш-пароль-приложения';
   ```

### Вариант 2: Использование Mail.ru

1. **Включите двухфакторную аутентификацию** в настройках Mail.ru

2. **Создайте пароль приложения**:
   - Перейдите в настройки безопасности Mail.ru
   - Создайте пароль для внешних приложений
   - Скопируйте сгенерированный пароль

3. **Обновите конфигурацию** в файле `lib/config/email_config.dart`:
   ```dart
   static const String smtpHost = 'smtp.mail.ru';
   static const int smtpPort = 465;
   static const bool useSsl = true;
   static const String senderEmail = 'ваш-email@mail.ru';
   static const String senderPassword = 'ваш-пароль-приложения';
   ```

### Вариант 3: Использование Yandex

1. **Включите двухфакторную аутентификацию** в настройках Yandex

2. **Создайте пароль приложения**:
   - Перейдите в настройки безопасности Yandex
   - Создайте пароль для приложений
   - Скопируйте сгенерированный пароль

3. **Обновите конфигурацию** в файле `lib/config/email_config.dart`:
   ```dart
   static const String smtpHost = 'smtp.yandex.ru';
   static const int smtpPort = 465;
   static const bool useSsl = true;
   static const String senderEmail = 'ваш-email@yandex.ru';
   static const String senderPassword = 'ваш-пароль-приложения';
   ```

## Тестирование

После настройки:

1. **Запустите приложение** в режиме отладки
2. **Попробуйте зарегистрироваться** с тестовым email
3. **Проверьте консоль** на наличие ошибок
4. **Проверьте почту** на наличие письма с кодом

## Логирование

В коде добавлено подробное логирование. Проверьте консоль на наличие сообщений:
- `AuthService: Начинаем регистрацию для...`
- `EmailService: Начинаем отправку кода на...`
- `EmailService: Письмо успешно отправлено`

## Возможные ошибки

1. **"Authentication failed"** - неправильный пароль приложения
2. **"Connection timeout"** - проблемы с сетью или неправильный порт
3. **"SSL/TLS error"** - неправильные настройки SSL

## Альтернативное решение

Если email не работает, можно временно отключить подтверждение email и использовать только Supabase аутентификацию:

1. Измените `AuthService.signUpWithEmail` чтобы сразу создавать пользователя в Supabase
2. Уберите вызов `EmailService.sendVerificationCode`
3. Установите `needsEmailConfirmation = false`
